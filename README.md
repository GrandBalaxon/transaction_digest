# Transaction Digest

## Описание:

Этот проект представляет собой бэкенд-компонент виджета для личного кабинета клиента банка. 
Виджет отображает несколько последних успешных банковских операций клиента.

## Установка:

1.  Установите [Poetry](https://python-poetry.org/docs/#installation).

2. Установите [Git](https://git-scm.com/downloads/win).

3. Клонируйте репозиторий:
```
git clone https://github.com/GrandBalaxon/transaction_digest.git
cd TransactionDigest
```

4. Установите зависимости проекта:
```
poetry install
```

## Использование:

(Здесь нужно будет добавить инструкции по использованию, когда `main.py` будет реализован)

## Функциональность:

Проект состоит из нескольких модулей в пакете `src`, выполняющих следующие функции:

### `masks.py`
Предоставляет функции для маскировки номеров банковских карт и счетов в соответствии с политиками безопасности банка.
   * `get_mask_card_number(card_number)`: Маскирует номер карты в формате `XXXX XX** **** XXXX`.
   * `get_mask_account(acc_number)`: Маскирует номер счета в формате `**XXXX`.
### `processing.py`
Предоставляет функции для фильтрации и сортировки данных об операциях.
   * `filter_by_state(list_of_dicts, state="EXECUTED")`: Фильтрует список операций по статусу (по умолчанию "EXECUTED").
   * `sort_by_date(list_of_dicts, descending=True)`: Сортирует список операций по дате (по умолчанию в порядке убывания).
### `widget.py`
Предоставляет функции для форматирования данных для виджета.
   * `mask_account_card(type_and_number)`: Маскирует номер карты или счета в строке.
   * `get_date(date)`: Форматирует дату в формат `ДД.ММ.ГГГГ`.
### `generators.py`
Предоставляет функции для генерации для работы с массивами данных.
#### `filter_by_currency(transactions_list, currency)` 
   Функция-генератор которая принимает на вход список словарей с транзакциями.
   Возвращает итератор, который поочередно выдает транзакции, где валюта операции соответствует заданной "currency" 
   (например, USD).
#### `transaction_descriptions(transactions_list)`
   Функция-генератор которая принимает список словарей с транзакциями. 
   Возвращает генератор выдающий описание каждой операции по очереди.
   * `card_number_generator(start, finish)`: Функция-генератор который выдает номера банковских карт в формате "XXXX XXXX XXXX XXXX", где X — цифра номера карты.
    Генератор может сгенерировать номера карт в заданном диапазоне от 0000 0000 0000 0001 до 9999 9999 9999 9999.
    Генерация значений происходит от меньшего к большому.
    На start и finish подаются строковые или численные значения.
    При указывании значения от большего к меньшему - функция всё равно отработает как полагается, поменяв их местами.

      Пример использования:


Формат входных данных словаря на работу с которым настроены функции:
```
"id": 939719570,
          "state": "EXECUTED",
          "date": "2018-06-30T02:08:58.425572",
          "operationAmount": {
              "amount": "9824.07",
              "currency": {
                  "name": "USD",
                  "code": "USD"
              }
          },
          "description": "Перевод организации",
          "from": "Счет 75106830613657916952",
          "to": "Счет 11776614605963066702"
```

## Тестирование 

Этот проект использует `pytest` для автоматизированного тестирования.
Он должен быть уже у вас установлен, если вы прошли шаги с установкой проекта. 

Перед началом тестирования убедитесь, что у вас активировано виртуальное окружение проекта, а также, что вы находитесь в корневой директории проекта.

Для запуска всех тестов из директории `tests/` используйте команду:
```bash
pytest
```

Для проверки покрытия кода использован `pytest-cov`.
* Используйте следующую команду для отображения информации о покрытии внутри терминала
```bash
pytest --cov
```
* чтобы сгенерировать отчет о покрытии в HTML-формате, где `src` — пакет c модулями, которые тестируем. 
Отчет будет сгенерирован в папке `htmlcov` и храниться в файле с названием `index.html`.
```bash
pytest --cov=src --cov-report=html
```

## Лицензия:

Этот проект лицензирован по [лицензии MIT](LICENSE).

